{% extends "officialbase.html" %}

{% block title %}Health Compliance Review{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3 class="text-center">Health Compliance Review for {{ store.store_name }} (ID: {{ store.store_id }})</h3>


    <form method="POST">
        <!-- ✅ Hidden field for store ID -->
        <input type="hidden" name="store_id" value="{{ store.id }}">

         <!-- Sanitary Facilities Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Sanitary Facilities</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="sanitary_facilities" value="staff_latrines"> Staff latrines</label><br>
            <label><input type="checkbox" name="sanitary_facilities" value="customer_latrines"> Customer latrines</label><br>
            <label><input type="checkbox" name="sanitary_facilities" value="no_latrines"> Shared </label><br>
        </div>
    </div>

    <!-- Cleaning Facilities Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Cleaning Facilities</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="cleaning_facilities" value="sinks_available"> Sinks available</label><br>
            <label><input type="checkbox" name="cleaning_facilities" value="disinfectants"> Disinfectants provided</label><br>
            <label><input type="checkbox" name="cleaning_facilities" value="cleaning_tools"> Cleaning tools available</label><br>
        </div>
    </div>

    <!-- Hand Washing Stations Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Hand Washing Stations</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="handwashing_facilities" value="handwashing_soap"> Soap provided </label><br>
            <label><input type="checkbox" name="handwashing_facilities" value="handwashing_water"> Running water available</label><br>
            <label><input type="checkbox" name="handwashing_facilities" value="handwashing_dryers"> Clean towels available </label><br>
        </div>
    </div>

    <!-- Waste Disposal Methods Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Waste Disposal Methods</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="waste_disposal" value="waste_regular_collection"> Regular waste collection </label><br>
            <label><input type="checkbox" name="waste_disposal" value="waste_segregation"> Segregated waste bins</label><br>
            <label><input type="checkbox" name="waste_disposal" value="waste_bin_lids"> Bins with lids </label><br>
        </div>
    </div>

    <!-- Food Handling Protocols Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Food Handling Protocols</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="food_handling" value="food_handling_training"> Staff trained in food handling</label><br>
            <label><input type="checkbox" name="food_handling" value="food_handling_gloves"> Staff use gloves</label><br>
            <label><input type="checkbox" name="food_handling" value="food_handling_containers"> Food stored in sealed containers</label><br>
            <label><input type="checkbox" name="food_handling" value="food_handling_expiry"> Food expiry dates checked daily</label><br>
        </div>
    </div>

    <!-- Food Storage Facilities Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Food Storage Facilities</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="food_storage" value="food_storage_refrigeration"> Appropriate Fridge(s) temperatures maintained</label><br>
            <label><input type="checkbox" name="food_storage" value="food_storage_drygoods"> Dry goods stored on shelves</label><br>
            <label><input type="checkbox" name="food_storage" value="food_storage_pallets"> Pallets elevate goods from ground</label><br>
        </div>
    </div>

    <!-- Food Preparation Protocols Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Food Preparation Protocols</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="food_preparation" value="food_preparation_clean"> Food preparation area clean</label><br>   
            <label><input type="checkbox" name="food_preparation" value="food_preparation_gloves"> Staff use gloves</label><br>
            <label><input type="checkbox" name="food_preparation" value="food_preparation_hairnets"> Staff wear hairnets</label><br>
            <label><input type="checkbox" name="food_preparation" value="food_preparation_aprons"> Staff wear aprons</label><br>
        </div>
    </div>

    <!-- Food Preparation Tools Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Food Preparation Tools</h5>
        </div>
        <div class="card-body">
            <label><input type="checkbox" name="food_tools" value="food_tools_clean_surfaces"> Sanitized and clean surfaces</label><br>
            <label><input type="checkbox" name="food_tools" value="food_tools_cutlery"> Sanitized utensils and cutlery</label><br>
            <label><input type="checkbox" name="food_tools" value="food_tools_prevention"> Cross contamination prevention methods exist</label><br>
        </div>
    </div>

    <!-- Number of Employees Card -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Number of Employees</h5>
        </div>
        <div class="card-body">
            <!-- ✅ Checkbox for Men -->
            <label>
                <input type="checkbox" id="men-checkbox" name="men_employed_checkbox">
                Men:
            </label>
            <input type="number" id="men-employed" name="men_employed" min="0" disabled><br>

            <!-- ✅ Checkbox for Women -->
            <label>
                <input type="checkbox" id="women-checkbox" name="women_employed_checkbox">
                Women:
            </label>
            <input type="number" id="women-employed" name="women_employed" min="0" disabled><br>

            <!-- ✅ Total Employees (Auto-Calculated) -->
            <label for="total-employed">Total:</label>
            <input type="number" id="total-employed" name="total_employed" min="0" readonly>
        </div>
</div>

        <div class="form-group col-md-6 mx-auto text-center mt-4">
            <button type="submit" class="btn btn-primary">Submit Review</button>
        </div>
    </form>

    <div class="text-center mt-4">
        {% if store %}
            <a href="{{ url_for('mncview.official_health_review', store_id=store.store_id) }}" class="btn btn-secondary">Back to Review</a>
        {% else %}
            <a href="{{ url_for('mncview.official_store_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
        {% endif %}
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const menCheckbox = document.getElementById("men-checkbox");
        const womenCheckbox = document.getElementById("women-checkbox");
        const menInput = document.getElementById("men-employed");
        const womenInput = document.getElementById("women-employed");
        const totalInput = document.getElementById("total-employed");

        function updateTotal() {
            let menCount = menCheckbox.checked ? parseInt(menInput.value) || 0 : 0;
            let womenCount = womenCheckbox.checked ? parseInt(womenInput.value) || 0 : 0;
            totalInput.value = menCount + womenCount;
        }

        menCheckbox.addEventListener("change", function() {
            menInput.disabled = !this.checked;
            if (!this.checked) menInput.value = ""; 
            updateTotal();
        });

        womenCheckbox.addEventListener("change", function() {
            womenInput.disabled = !this.checked;
            if (!this.checked) womenInput.value = ""; 
            updateTotal();
        });

        menInput.addEventListener("input", updateTotal);
        womenInput.addEventListener("input", updateTotal);
    });
</script>

{% endblock %}

